<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MySQL相关总结 | Keep Calm</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="业精于勤；荒于嬉；行成于思；毁于随。">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <link rel="preload" href="/assets/css/0.styles.27f90960.css" as="style"><link rel="preload" href="/assets/js/app.39eb54cf.js" as="script"><link rel="preload" href="/assets/js/3.e4e4b764.js" as="script"><link rel="preload" href="/assets/js/1.9af89bd4.js" as="script"><link rel="preload" href="/assets/js/19.b7deea6e.js" as="script"><link rel="prefetch" href="/assets/js/10.a9a7b3e7.js"><link rel="prefetch" href="/assets/js/11.c737f90a.js"><link rel="prefetch" href="/assets/js/12.fa966447.js"><link rel="prefetch" href="/assets/js/13.30255140.js"><link rel="prefetch" href="/assets/js/14.da2feb12.js"><link rel="prefetch" href="/assets/js/15.418341f6.js"><link rel="prefetch" href="/assets/js/16.57befc19.js"><link rel="prefetch" href="/assets/js/17.55efde44.js"><link rel="prefetch" href="/assets/js/18.6852bfe1.js"><link rel="prefetch" href="/assets/js/20.7c0f462f.js"><link rel="prefetch" href="/assets/js/21.4beaac2e.js"><link rel="prefetch" href="/assets/js/22.f63264ea.js"><link rel="prefetch" href="/assets/js/23.0afe25a8.js"><link rel="prefetch" href="/assets/js/24.fe67d7bb.js"><link rel="prefetch" href="/assets/js/25.89d72f85.js"><link rel="prefetch" href="/assets/js/26.a6feec8b.js"><link rel="prefetch" href="/assets/js/27.2a476698.js"><link rel="prefetch" href="/assets/js/4.f4da4cbd.js"><link rel="prefetch" href="/assets/js/5.7c6ef725.js"><link rel="prefetch" href="/assets/js/6.c12cee0f.js"><link rel="prefetch" href="/assets/js/7.851df97a.js"><link rel="prefetch" href="/assets/js/8.c3da3f1c.js"><link rel="prefetch" href="/assets/js/9.63f2a2fc.js">
    <link rel="stylesheet" href="/assets/css/0.styles.27f90960.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-19557b78><div data-v-19557b78><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-19557b78 data-v-19557b78><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-64685f0e data-v-19557b78 data-v-19557b78><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>Keep Calm</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>yangzq</span>
            
          <!---->
          2020
        </a></span></div></div> <div class="hide" data-v-19557b78><header class="navbar" data-v-19557b78><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.jpg" alt="Keep Calm" class="logo"> <span class="site-name">Keep Calm</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/Deepin/" class="nav-link"><i class="iconfont undefined"></i>
  Deepin
</a></li><li class="dropdown-item"><!----> <a href="/categories/Docker/" class="nav-link"><i class="iconfont undefined"></i>
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/categories/Emacs/" class="nav-link"><i class="iconfont undefined"></i>
  Emacs
</a></li><li class="dropdown-item"><!----> <a href="/categories/Java/" class="nav-link"><i class="iconfont undefined"></i>
  Java
</a></li><li class="dropdown-item"><!----> <a href="/categories/MyBatis/" class="nav-link"><i class="iconfont undefined"></i>
  MyBatis
</a></li><li class="dropdown-item"><!----> <a href="/categories/Spring/" class="nav-link"><i class="iconfont undefined"></i>
  Spring
</a></li><li class="dropdown-item"><!----> <a href="/categories/Vue/" class="nav-link"><i class="iconfont undefined"></i>
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/categories/Linux/" class="nav-link"><i class="iconfont undefined"></i>
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/categories/NetWork/" class="nav-link"><i class="iconfont undefined"></i>
  NetWork
</a></li><li class="dropdown-item"><!----> <a href="/categories/MySQL/" class="nav-link"><i class="iconfont undefined"></i>
  MySQL
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/recoluan" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-19557b78></div> <aside class="sidebar" data-v-19557b78><div class="personal-info-wrapper" data-v-b038cec6><img src="/logo.jpg" alt="author-avatar" class="personal-img" data-v-b038cec6> <h3 class="name" data-v-b038cec6>
    yangzq
  </h3> <div class="num" data-v-b038cec6><div data-v-b038cec6><h3 data-v-b038cec6>14</h3> <h6 data-v-b038cec6>Article</h6></div> <div data-v-b038cec6><h3 data-v-b038cec6>6</h3> <h6 data-v-b038cec6>Tag</h6></div></div> <hr data-v-b038cec6></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/Deepin/" class="nav-link"><i class="iconfont undefined"></i>
  Deepin
</a></li><li class="dropdown-item"><!----> <a href="/categories/Docker/" class="nav-link"><i class="iconfont undefined"></i>
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/categories/Emacs/" class="nav-link"><i class="iconfont undefined"></i>
  Emacs
</a></li><li class="dropdown-item"><!----> <a href="/categories/Java/" class="nav-link"><i class="iconfont undefined"></i>
  Java
</a></li><li class="dropdown-item"><!----> <a href="/categories/MyBatis/" class="nav-link"><i class="iconfont undefined"></i>
  MyBatis
</a></li><li class="dropdown-item"><!----> <a href="/categories/Spring/" class="nav-link"><i class="iconfont undefined"></i>
  Spring
</a></li><li class="dropdown-item"><!----> <a href="/categories/Vue/" class="nav-link"><i class="iconfont undefined"></i>
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/categories/Linux/" class="nav-link"><i class="iconfont undefined"></i>
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/categories/NetWork/" class="nav-link"><i class="iconfont undefined"></i>
  NetWork
</a></li><li class="dropdown-item"><!----> <a href="/categories/MySQL/" class="nav-link"><i class="iconfont undefined"></i>
  MySQL
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/recoluan" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>MySQL相关总结</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/views/MySQL/2020/MySQL.html#mysql索引" class="sidebar-link">MySQL索引</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/views/MySQL/2020/MySQL.html#什么是索引" class="sidebar-link">什么是索引</a></li><li class="sidebar-sub-header"><a href="/views/MySQL/2020/MySQL.html#平衡二叉树" class="sidebar-link">平衡二叉树</a></li><li class="sidebar-sub-header"><a href="/views/MySQL/2020/MySQL.html#myisam" class="sidebar-link">myisam</a></li><li class="sidebar-sub-header"><a href="/views/MySQL/2020/MySQL.html#innodb" class="sidebar-link">innoDB</a></li><li class="sidebar-sub-header"><a href="/views/MySQL/2020/MySQL.html#innodb和myisam的区别" class="sidebar-link">innoDB和myisam的区别</a></li><li class="sidebar-sub-header"><a href="/views/MySQL/2020/MySQL.html#innodb为什么推荐使用自增id作为主键？" class="sidebar-link">Innodb为什么推荐使用自增ID作为主键？</a></li><li class="sidebar-sub-header"><a href="/views/MySQL/2020/MySQL.html#聚集索引" class="sidebar-link">聚集索引</a></li><li class="sidebar-sub-header"><a href="/views/MySQL/2020/MySQL.html#非聚集索引" class="sidebar-link">非聚集索引</a></li><li class="sidebar-sub-header"><a href="/views/MySQL/2020/MySQL.html#联合索引" class="sidebar-link">联合索引</a></li></ul></li><li><a href="/views/MySQL/2020/MySQL.html#mysql面试题" class="sidebar-link">MySQL面试题</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/views/MySQL/2020/MySQL.html#数据库查询优化" class="sidebar-link">数据库查询优化</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/views/MySQL/2020/MySQL.html#sql优化" class="sidebar-link">SQL优化</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/views/MySQL/2020/MySQL.html#数据库事务" class="sidebar-link">数据库事务</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/views/MySQL/2020/MySQL.html#数据库设计三范式" class="sidebar-link">数据库设计三范式</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/views/MySQL/2020/MySQL.html#数据库五大约束" class="sidebar-link">数据库五大约束</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-64685f0e data-v-19557b78><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>MySQL相关总结</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>yangzq</span>
            
          <!---->
          2020
        </a></span></div></div> <div data-v-19557b78><main class="page"><div class="page-title" style="display:none;"><h1>MySQL相关总结</h1> <hr> <div data-v-484a899e><i class="iconfont reco-account" data-v-484a899e><span data-v-484a899e>yangzq</span></i> <i class="iconfont reco-date" data-v-484a899e><span data-v-484a899e>2020-05-02</span></i> <!----> <i class="iconfont reco-tag tags" data-v-484a899e><span class="tag-item" data-v-484a899e>
      DataBase
    </span></i></div></div> <div class="theme-reco-content content__default" style="display:none;"><h1 id="mysql相关总结"><a href="#mysql相关总结" class="header-anchor">#</a> MySQL相关总结</h1> <h2 id="mysql索引"><a href="#mysql索引" class="header-anchor">#</a> MySQL索引</h2> <h3 id="什么是索引"><a href="#什么是索引" class="header-anchor">#</a> 什么是索引</h3> <p>索引是帮助数据库高效获取数据的<strong>排好序</strong>的<strong>数据结构</strong>。</p> <h3 id="平衡二叉树"><a href="#平衡二叉树" class="header-anchor">#</a> 平衡二叉树</h3> <h4 id="二叉搜索树"><a href="#二叉搜索树" class="header-anchor">#</a> 二叉搜索树</h4> <p>二叉树中对于比中间节点小的数据放在树的左边，比中间节点大的放在右边。</p> <h4 id="红黑树"><a href="#红黑树" class="header-anchor">#</a> 红黑树</h4> <h5 id="特征"><a href="#特征" class="header-anchor">#</a> 特征</h5> <ol><li>节点是红色或是黑色</li> <li>根节点是黑色</li> <li>所有叶子都是黑色（叶子是NUIL节点）</li> <li>每个红色节点的两个子节点都是黑色（从每个叶子到根的所有路径上不能有两个连续的红色节点）</li> <li>从任一节点到其每个叶子的所有路径都包含相同数目的黑色节点</li></ol> <h4 id="红黑树较于二叉树的优点"><a href="#红黑树较于二叉树的优点" class="header-anchor">#</a> 红黑树较于二叉树的优点</h4> <ol><li>二叉树会存在左节点或右节点过长的情况</li></ol> <h4 id="红黑树无法做索引数据结构的原因"><a href="#红黑树无法做索引数据结构的原因" class="header-anchor">#</a> 红黑树无法做索引数据结构的原因</h4> <p>存在树深度过长的情况</p> <h4 id="b树"><a href="#b树" class="header-anchor">#</a> B树</h4> <ul><li>叶子节点具有相同的深度，叶子节点的指针为空</li> <li>所有索引的元素不重复</li> <li>节点中的数据索引从左到右递增排列
B树相较于红黑树在每个节点上存储的数据量更多，使得能够在深度不是太多的情况下保存更多的数据</li></ul> <h4 id="b-树（b树变种）"><a href="#b-树（b树变种）" class="header-anchor">#</a> B+树（B树变种）</h4> <ul><li>非叶子节点不存储data，只存储索引（在不同的叶子节点存储父节点的索引），可以放更多的索引</li> <li>叶子节点包含所有的索引</li> <li>叶子节点用指针连接，提高区间访问的性能</li></ul> <h3 id="myisam"><a href="#myisam" class="header-anchor">#</a> myisam</h3> <ul><li>.frm文件 -&gt;数据库表结构文件</li> <li>.MYD -&gt; 数据库表数据文件</li> <li>.MYI -&gt; 数据库表索引文件</li></ul> <h3 id="innodb"><a href="#innodb" class="header-anchor">#</a> innoDB</h3> <h3 id="innodb和myisam的区别"><a href="#innodb和myisam的区别" class="header-anchor">#</a> innoDB和myisam的区别</h3> <ol><li>InnoDB支持事务，myisam不支持事务。InnoDB每一条SQL语句都默认封装成事务，自动提交，这样会影响速度，所以最好把多个SQL语句放在begin和commit之间。</li> <li>InnoDB支持外键，myisam不支持外键，对于一个含有外键的InnoDB表转换成myisam会失败。</li> <li>Innodb是聚集索引，使用的是B+树作为索引结构数据文件和索引文件绑定在一起，必须要有主键，通过主键索引效率很高，但是辅助索引需要两次查询，先查询到主键，然后通过主键查询到数据，因此，主键的不应该过大，因为主键过大可能会导致其他的索引也都会很大。
myisam是非聚集索引，也是使用B+树索引结构，索引和数据文件是分离的，索引保存的是数据文件的指针。主键索引和辅助索引是独立的</li> <li>InnoDB不保存表的具体行数，在执行select count(*) 语句时会进行全表遍历，而myisam用一个变量保存整个表的行数。（InnoDB不支持的原因是事务性）</li> <li>InnoDB不支持全文检索，而myisam支持全文检索，PS：在5.7之后InnoDB开始支持全文检索。</li> <li>Myisam表格可以被压缩之后可以进行查询。</li> <li>InnoDB支持表、行（默认）级锁，而Myisam只支持表级锁。（InnoDB的行锁实际上是在索引上的，而不是锁在物理记录行上，潜台词时，如果未命中索引，就无法使用行锁，退化为表锁）</li> <li>InnoDB表必须要有主键（用户没有指定的话会自己找或生成一个主键），而myisam可以没有。</li> <li>Innodb存储文件有frm、ibd，而Myisam是frm、MYD、MYI</li></ol> <ul><li>Innodb：frm是表定义文件，ibd是数据文件</li> <li>Myisam：frm是表定义文件，myd是数据文件，myi是索引文件</li></ul> <h3 id="innodb为什么推荐使用自增id作为主键？"><a href="#innodb为什么推荐使用自增id作为主键？" class="header-anchor">#</a> Innodb为什么推荐使用自增ID作为主键？</h3> <p>自增id可以保证每次插入时B+树索引是向右扩展的，可以避免树的频繁合并和分裂。如果使用字符串主键和随机主键，会使得数据随机插入，效率比较差。搜索二叉树在新增时会进行数据之间的比较，如果是字符串作为主键，存在比较复杂的情况。</p> <h3 id="聚集索引"><a href="#聚集索引" class="header-anchor">#</a> 聚集索引</h3> <ul><li>定义：数据行的物理顺序与列（一般是主键的那一列）的逻辑顺序相同，一个表中只能拥有一个聚集索引</li></ul> <h3 id="非聚集索引"><a href="#非聚集索引" class="header-anchor">#</a> 非聚集索引</h3> <ul><li>定义：该索引中索引的逻辑顺序与磁盘上行的物理存储顺序不同，一个表中可以拥有多个非聚集索引。</li></ul> <h3 id="联合索引"><a href="#联合索引" class="header-anchor">#</a> 联合索引</h3> <ul><li><p>索引最左前缀原则</p></li> <li><p>innodb引擎的4大特性</p></li></ul> <p>插入缓冲（insert buffer),二次写(double write),自适应哈希索引(ahi),预读(read ahead)</p> <h2 id="mysql面试题"><a href="#mysql面试题" class="header-anchor">#</a> MySQL面试题</h2> <ol><li><p>为什么要一定设置主键</p> <p>如果定义了主键，那么InnoDB会选择主键作为聚集索引，如果没有定义主键，MySQL会选择第一个不含NULL的值的唯一索引作为主键索引，如果也没有这样的索引，则InnoDB会选择内置6字节长的ROWID作为隐含的聚集索引。</p></li> <li><p>自增主键用完了怎么办</p> <p>这个问题我们没有遇到过，我们一般把主键的数据类型设置为bigint，在数据量过大的时候我们考虑的是使用分库分表，用redis来生成主键。</p></li> <li><p>时间用什么类型</p> <p>时间一般使用的是datetime类型，可以存储1000-01-01 00:00:00 ~ 9999-12-31 23:59:59之间的时间，但是一旦时区发生改变数据库的值不会发生改变。如果时间定义为TIMESTAMP，每当行被更改时，时间戳字段将获取当前时间戳。</p></li> <li><p>为什么不直接存储图片、音频、视频等大量内容？</p> <p>虽然在MySQL中支持BLOB类，但是在实际生产环境中不会使用，原因如下：</p> <ol><li>MySQL内存临时表不支持TEXT,BLOB这样的大数据类型，如果查询中存在这样的字段，会导致查询十分缓慢。</li> <li>数据库特别大，内存占用高，维护比较麻烦。</li> <li>binlog太大，如果是主从同步的结构，会导致主从同步效率问题。</li></ol></li> <li><p>char和varchar的区别</p> <ul><li>char：定长，效率高，一般存储固定长度的数据，最大长度为255，如果设置了长度，会用空格补足剩余的字段。</li> <li>varchar: 不定长，效率偏低，最大长度为65535，不会进行空格的补全。</li> <li>InnoDB推荐使用varchar</li></ul></li> <li><p>MySQL如何选择float, double, decimal</p> <ul><li>浮点数如果不写经度和标度，会按照实际精度值保存，如果有精度和标度，则会自动将四舍五入后的结果插入，系统不会报错；定点数如果不写精度和标度，则按照默认值decimal(10,0) 来操作，如果数据超过了精度和标度值，系统会报错。
<img src="/MySQL/float.png" alt="float,double,decimal" title="float"></li></ul></li> <li><p>BLOB和TEXT有什么区别？</p> <ul><li>BLOB和TEXT类型之间的唯一区别在于对BLOB值进行排序和比较时区分大小写，对TEXT值不区分大小写。</li></ul></li> <li><p>常用的SQL语句分类</p> <ul><li>DDL:数据定义语句，包括create，drop,alter</li> <li>DQL:数据查询语句，包括select</li> <li>DML:数据操纵语句，包括update，insert，delete</li> <li>DCL:数据控制语句，包括GRANT,REVOKE,COMMIT,ROLLBACK</li></ul></li> <li><p>MySQL中in和exists区别
MySQL中in语句是把外表和内表做hash连接，而exists语句是对外表做loop循环，每次loop循环在对内表进行查询，如何使用应当按照具体的环境进行使用：</p> <ol><li>如果两个表的数据量差别不大，那么用in和exists差别不大</li> <li>如果两个表中一个表大，一个小，则子查询表大的用exists，小的用in</li> <li>not in 和not exists，如果查询语句中使用了not in，那么内外表都就进行全局扫描，没有用到索引，而not exists的子查询依然能用到表的索引，无论那个表大，用not exists都比not in要快。</li></ol></li></ol> <h2 id="数据库查询优化"><a href="#数据库查询优化" class="header-anchor">#</a> 数据库查询优化</h2> <ol><li>where语句的执行顺序是怎样的？
where语句执行的顺序是从左到右执行的，在数据量小的时候不用去考虑，但是在数据量多的时候要考虑先后顺序，此时遵循一个原则：排除越多的条件放在第一个。</li> <li>创建索引的规则
<ul><li>在经常搜索的列上添加索引，可以加快搜索速度</li> <li>在经常用在连接的列上，可以加快搜索速度</li> <li>在经常需要范围搜索的列上创建索引，因为索引已经排序，其指定范围是连续的</li> <li>在经常需要排序的列上创建索引，因为索引已经排序，可以加快搜索速度</li> <li>在经常使用where子句的列上创建索引，加快条件判断的速度</li></ul></li> <li>MySQL联合索引
联合索引是两个或者两个以上列上的索引。对于联合索引MySQL从左到右的使用索引中的字段，一个查询只使用索引中的一部分，但只能是最左侧部分。例如索引是key index(a,b,c),可以支持a,a b,a b c三种查询，但是不支持b c这种查询，当最左侧字段是常量引用时，索引就十分有效。</li></ol> <h2 id="sql优化"><a href="#sql优化" class="header-anchor">#</a> SQL优化</h2> <ol><li>在表中建立索引，优先考虑where和group by语句上</li> <li>避免使用select *</li> <li>尽量避免使用in和not in，会导致数据库引擎放弃索引而进行全表扫描，可以使用exist代替</li> <li>尽量避免使用or</li> <li>尽量避免在模糊查询前用%</li> <li>尽量避免进行null判断</li> <li>尽量避免在where条件中等号的左侧进行表达式和函数操作。</li> <li>当数据量大时避免使用where 1 =1 条件</li></ol> <h2 id="数据库事务"><a href="#数据库事务" class="header-anchor">#</a> 数据库事务</h2> <ol><li><p>事务的概念</p> <blockquote><p>Transactions are not a law of nature; they were created with a purpose, namely to simplify the programming model for applications accessing a database. By using transactions, the application is free to ignore certain potential error scenarios and concurrency issues, because the database takes care of them instead (we call these safety guarantees).</p></blockquote> <p>事务并不是自然规律， 创建它们的目的是简化用于访问数据库的应用程序的编程模型。 通过使用事务，应用程序可以自由地忽略某些潜在的错误情况和并发问题，因为数据库将代替它们来处理它们（我们将其称为安全保证）。</p></li> <li><p>事务的特性</p> <ul><li>原子性：对于事务的所有的操作，要么全部成功，要么全部失败。</li> <li>一致性：在事务执行前后，应用系统的状态是一致的。</li> <li>隔离性：多个事务之间不会相互影响。</li> <li>持久性：事务提交成功后，所有的数据都会持久保存到磁盘中。
<strong>对于事务的一致性的理解</strong>:应用系统从一个正确的状态到另一个正确的状态.而ACID就是说事务能够通过AID来保证这个C的过程.C是目的,AID都是手段.</li></ul></li> <li><p>脏读、不可重复读、幻读</p> <ul><li>脏读：是指一个事务中读取到了另一个事务中未提交的数据</li> <li>不可重复读：在一个事务内根据相同的查询条件进行多次查询，查询出来的结果是不一样的。原因是由于别的事务修改了一部分数据。</li> <li>幻读：在一个事务内多次查询返回的结果集不一致（比如新增和删除了部分数据）</li></ul></li> <li><p>事务的隔离级别</p> <ul><li>读未提交：所有的事务都可以读取到别的事务未提交的执行结果。</li> <li>读已提交：一个事务只能看到已经提交的事务所作的改变。（Oracle默认的事务级别）</li> <li>可重复读：能确保用一个事务的多个实例在并发读取数据时，会看到相同的数据行。这会导致另一个棘手的问题：“幻读”。InnoDB和Falcon存储引擎通过多版本并发控制（MVCC）机制解决了该问题</li> <li>串行读： 这是最高的事务隔离级别，使得所有的操作都是串行执行，并发情况下会有性能问题。</li></ul></li></ol> <table><thead><tr><th></th> <th>脏读</th> <th>不可重复读</th> <th>幻读</th></tr></thead> <tbody><tr><td>读未提交</td> <td>√</td> <td>√</td> <td>√</td></tr> <tr><td>读已提交</td> <td></td> <td>√</td> <td>√</td></tr> <tr><td>可重复读</td> <td></td> <td></td> <td>√</td></tr> <tr><td>串行读</td> <td></td> <td></td> <td></td></tr></tbody></table> <h2 id="数据库设计三范式"><a href="#数据库设计三范式" class="header-anchor">#</a> 数据库设计三范式</h2> <ul><li><p>第一范式：表中的每一列必须是不可拆分的最小单元，确保每一列的原子性。满足第一范式时关系模型规范化的最低要求，否则，将有很多基本操作在这些关系模式中无法实现。（所有的关系型数据库都满足第一范式）</p></li> <li><p>第二范式：关系模式必须满足第一范式，并且所有非主属性都完全依赖主码。</p> <ul><li>主码：在数据表中有属性K，假设在K确定的情况下，该表中除K以外的所有属性值随之确定，那么K就是主码（K相当于主键）。</li> <li>主属性：包含在任何一个码中的属性称为主属性。</li> <li>非主属性：除了主属性之外的属性。</li></ul></li> <li><p>第三范式：满足2NF后，要求：表中的每一列都要与主键直接相关，而不是间接相关（表中的每一列只能依赖于主键）。</p> <p>第二范式与第三范式的区别：是否存在多张表，第三范式描述的是多张表之间的关系，一张表中只能有另一张表的主码，而不能有别的信息。
<strong>注意</strong>：必须先满足第一范式才能满足第二范式，必须同时满足第一第二范式才能满足第三范式。</p></li></ul> <h2 id="数据库五大约束"><a href="#数据库五大约束" class="header-anchor">#</a> 数据库五大约束</h2> <ul><li>主键约束：唯一性，非空性</li> <li>唯一约束：唯一性，可以为空，但是只能有一个</li> <li>默认约束：该数据的默认值</li> <li>外键约束：需要建立两张表之间的关系</li> <li>非空约束：设置非空约束，表示改字段不能为空。</li></ul></div> <footer class="page-edit" style="display:none;"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">5/3/2020, 4:19:13 PM</span></div></footer> <!----> <!----></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-44bd5a18 data-v-44bd5a18><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-44bd5a18><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-44bd5a18></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-44bd5a18></path></svg></div></div></div>
    <script src="/assets/js/app.39eb54cf.js" defer></script><script src="/assets/js/3.e4e4b764.js" defer></script><script src="/assets/js/1.9af89bd4.js" defer></script><script src="/assets/js/19.b7deea6e.js" defer></script>
  </body>
</html>
